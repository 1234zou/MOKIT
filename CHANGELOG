MOKIT 1.2.7rc10 (Sep 11, 2025)
------------------------
Fixes
* consider sys.path[0]='' when simply starting python from the current terminal
* make sys.path include the current directory when Python script is in a different directory
* fix ndb when the user specifies an active space different from default
* fix the bug of reading GAMESS (MR)SF-CIS/TD excitation coefficients
* fix frozen core option bug when ECP/PP is used in autosr
* fix element upper/lower case bug in GENBAS generated by fch2cfour introduced in commit a512cc84
* fix -1 case lost in subroutine read_mark_from_shltyp_sph/cart introduced in commit a512cc84
* fix bug of uninitialized den array when calculating densities in py2fch.f90
* fix bug of reading PySCF UCCSD(T) and RI-RCCSD(T) energy
* fix the npair<=0 case in get_npair_and_ovidx
* support basis set linear dependency in fch2dal
* add implicit-external option for recent versions of fortran-lang fpm
* fix bug caused by simultaneously reading fixed filenames of multiple jobs
* update nmo_b in molden2fch when basis set linear dep. occurs
* fix fch2inp error introduced in 1.2.7rc1 when ECP and ghost atoms both exist
* fix occasional bug ModuleNotFoundError in load_mol_from_fch
Features
* add FIC-NEVPT3/FIC-NEVPT4(SD) interface to ORCA
* add qchem2pyscf in qchem.f90
* add ROHF -> MRSF-CIS -> SA-NO -> SA-CASSCF as default SA strategy for open-shell singlet
* add CASCI excited state interface to ORCA
* add (DMRG-)CASCI excited state interface to PySCF
* add subroutine fch2hess in rwgeom.f90
* add Python module py2mrcc for PySCF -> MRCC
* add utility mkl2mrcc for ORCA -> MRCC
* add utility fch2mrcc for Gaussian -> MRCC
* add `ions_centers` option to loc() and pbc_loc()
* allow arbitrary number of active electrons/orbitals for SS-CAS, SA-CAS, and post-CAS
* ist=7 for UHF -> SUHF NO -> (associated rotation ->) CASCI/CASSCF -> ...
* load a cell object using load_cell_from_fch
* support automatic SS-DMRG-CASSCF orbital optimization by calling PySCF+Block
* fast orbital localization of PBC gamma point for a large cell
* fast orbital localization using Cholesky/Atomic/Mixed LMOs as initial guess
* fast orbital localization using OpenMP parallel for large molecules
* add keywords ICSS_r and ICSS_intv in mokit{}
* add non-iterative basis set projection
* add EE-ADC(2)/ADC(3) interface to PSI4
* add IP-/EE-/EA-ADC(2) interface to ORCA
* add IP-/EE-/EA-ADC(2), IP-/EE-/EA-ADC(3) interface to PySCF
* add QCISD/QCISD(T) interface to ORCA >=6.0.1 and Gaussian
* add CCSD/CCSD(T)/CCSDT analytical gradient interface to ORCA >=6.0.1
Improvement
* add gms_dat_path in mr_keyword.f90, now gms_scr_path/gms_dat_path can be different
* add M052X and B972 (and dispersion correction) parameters in fch2mkl
* wrap atoms outside box back into box to save memory during PBC MLWF generation
* replace mkl2fch by molden2fch for ORCA CASCI/CASSCF NO conversion in do_cas.f90
* improve CASPT2/NEVPT2 settings based on excited state CASCI or SS-CASSCF
* add `NRAD=99 NLEB=590` into the $TDDFT group of GAMESS (MR)SF-TDDFT .inp file
* change mo_center in loc/pbc_loc() modules from dynamic arrays to derivative types
* use CIS SA-NTO instead of SA-NO when SA_NTO is written in mokit{}
* set RHF -> CIS -> SA-NO -> SA-CASSCF as default SA strategy for closed-shell singlet
* improve DMRG-CASCI/CASSCF workflow when using PySCF+Block2
* support specification of multiple on-top pair density functionals
* GVB(0) can be specified for a non-singlet calculation
* add mc.analyze() when CASSCF_prog=PySCF
* update molden2fch for compatibility with arbitrary number of normal modes
* print active space size for post-CAS calculations
* add MRCC support in add_bgcharge_to_inp
* replace RIJK by RICD when invoking RI in OpenMolcas
* add `-sfcis` and `-sasfcis` arguments for fch2qchem
* add `-sfcis` and `-novec` arguments for fch2inp
* add `-pbc` and `-obj` arguments for bas_gms2py and bas_fch2py
* discard pairs which have small tdm values in pair_by_tdm
* support automatic SS-CASSCF calculations (Xmult/=mult) via calling ORCA
* support DLPNO double hybrid keywords for `-dft` in fch2mkl
* support semi-empirical type .fch(k) in fch2amo and amo2fch
Re-factor and removal
* CASPT2_prog/NEVPT2_prog can still be used as alias when CASPT2/NEVPT2 specified
* change CASPT2_prog/NEVPT2_prog/NEVPT3_prog to CASPT_prog/NEVPT_prog
* add find_antibonding_orb() and find_antibonding_orb_in_fch() in lib/gaussian.py
* remove some basis reordering subroutines which have identical functionalities to others
* replace calc_dis_mat_from_coor by BOHR2ANG*gto.inter_distance for isolated molecules
* merge subroutines sym_ortho and can_ortho into gen_ortho_mo
* mv original subroutine orb_resemble into orb_resemble_iter
* remove construct_vir.f90 and move this subroutine into math_sub.f90

MOKIT 1.2.6 (Nov 14, 2024)
------------------------
Fixes
* fix bug in molden2fch for high-spin UHF/UKS wfn conversion
* fix solvent name conversion for GKS-EDA interface in frag_guess_wfn
* fix keyword bug in SA-DMRG-CASSCF
* fix recognition bug of the highest angular momentum in fch2cfour when low angular momentum diffuse functions are used
* fix GHF detection bug introduced in commit f0dbe662
* fix bug of calling Dalton to do MP2/CCSD when point charges are included
* fix fortran read bug in gvb_exclude_XH (for very high ang. mom. and >99 atoms)
* fix SS-DMRG-CASCI keywords
* fix 'Int Atom Types' dimension in addH2singlet
* fix bug (data out of range) in find_cos_quartic_poly_maximum
* fix bug ("two successive SP/L") in mkl2fch and molden2fch
* update get_mokit_loc.py
* fix bug of frozen core counting when large core ECP is used
* fix bug of DMRG excited calculation keywords
* fix bug in subroutine solve_ovlp_from_ctsc
* fix the bug of using CASCI obj in module fchk()
* fix bug of generating the F() array when NCO=0 in a GVB computation
Features
* add subroutines about finding (extra) antibonding orbitals
* add basis set files MINIX, vDZP, def2-mSVP, def2-mTZVP and def2-mTZVPP
* remove Gaussian dependency of HF calculation when `HF_prog=ORCA`
* add Jocobian 2*2 rotation RHF and conventional RHF
* add subroutine merge_bas_in_dalton_mol
* add utility amo2fch for Amesp->Gaussian
* update dat2fch to generate a .fch file from scratch
* add a new keyword LocDocc (associated with LocalM)
* add `-sf`,`-mrsf`,`-sasf` arguments for fch2mkl, fch2inp, fch2qchem
* put basis sets ANO-R1, ANO-R2 and ANO-R3 into `$MOKIT_ROOT/mokit/basis/`
* put basis sets cc-pVDZ-F12 and cc-pVTZ-F12 into `$MOKIT_ROOT/mokit/basis/`
* put basis sets cc-pVDZ-X2C and cc-pVTZ-X2C into `$MOKIT_ROOT/mokit/basis/`
* remove Gaussian dependency of HF calculation when `HF_prog=PySCF`
* support of ORCA/Turbomole/CFOUR/OpenMolcas/Molpro molden in molden2fch
* add DMRG-FIC-MRCISD interface (calling PySCF+Block2)
* add utilities molden2fch, fch2tm
* add interfaces for MP2, CCSD, CCSD(T) gradients in autosr
* add interfaces for MP2, CCSD, CCSD(T) NOs in autosr
* put basis sets x2c-SVPall, x2c-TZVPall, etc into `$MOKIT_ROOT/mokit/basis/`
* add subroutine mo_grassmann_intrplt
* add subroutine permute_atoms_wfn
* add utilities mkl2amo, mkl2bdf, mkl2cfour, mkl2com, mkl2dal, mkl2inp, mkl2inporb, mkl2psi, mkl2py, mkl2qchem
* update utility mkl2fch for generating .fch file from scratch
* add subroutines rotate_atoms_wfn and geom_lin_intrplt
* add fch2amo/py2amesp/qchem2amesp for Gaussian/PySCF/Q-Chem -> Amesp
* add module mirror_wfn
* add interfaces of RI-MP2/CCD/CCSD/CCSD(T) analytical gradients in autosr
* call programs to get analytical gradients of CASPT2 and MC-PDFT
* support HF_prog=PySCF in frag_guess_wfn
Improvement
* improved CCSD keywords in the interface to PySCF CC
* improved efficiency for reading MOs in molden2fch
* improved SS-CASSCF keywords
* update utility fch_u2r for R(O)HF->UHF file conversion
* auto-detect of def2 ECP/PP when `HF_prog=PySCF`
* update automr and autosr for better compatibility with ORCA 6
* re-distributions of lib.num_threads, mf.max_memory and X2C keywords
* disable state deletion in Dalton
* read [Pseudo] section in molden2fch for ORCA 6 molden
* update molden2fch to read partial MO coefficients
* take point charges into consideration for autosr
* optionally read `Int Atom Types` in fch
* add stability.py in mokit/lib/ for tight wfn stability check
* add parameters of 9 solvents in frag_guess_wfn
* improvement of RIJK_bas and RIC_bas settings
* add decontracted basis set in fch2psi when sfx2c is used
* change `-b3lyp` type to `-dft 'b3lyp'` type for fch2mkl
* automatically detect MPI/OpenMP version of Dalton
* support of I angular momentum in fch2mkl and mkl2fch
* modify Makefile to support OpenMP for some subroutines
* optimize DMRG OpenMP/MPI settings
* for atoms<=Xe in ist=3, use Gaussian instead of PySCF to do HF/STO-6G
* for atoms>Xe in ist=3, find antibonding orbitals by orbital rotations (def2-SVP removed)
* add support for ghost atoms in fch2mkl
* update fch2inporb to fit OpenMolcas>=23.02
* add readrhf/readuhf support in autosr
* change default MPI to OpenMP when calling Block
* set GVB_conv=5d-4 and FcGVB as default in (post-)CASSCF calculations
* add attribute natorb in subroutine py2fch
* update examples and tests (add prefix mokit.lib when importing Python modules)
Re-factor and removal
* change `closed,` to argument `-m15` for high spin case in fch2com and bas_gms2molpro
* move bas_gms2psi into fch2psi
* remove mo_svd_format.f90 and move this functionality into wfn_analysis
* standardize some subroutines to _from_dat and _from_gms_inp
* remove ZORA related basis sets

MOKIT 1.2.5 (Apr 27, 2023)
------------------------
* add support for ghost atoms in fch2inp, bas_gms2py and bas_fch2py
* fix DKH2/X2C bug when ist=0 and using old Gaussian (<= g09)
* add SS-CASSCF interface with OpenMolcas
* remove GNU sed dependence
* fix genecp and ecp_core bug
* add CC and DLPNO-CC interfaces in autosr
* state-tracking of SS-CASSCF orbital optimization using PySCF
* change MKL from 2021 to 2022 for the abnormal behavior of frag_guess_wfn in conda
* add keyword OnlyXH and update utility gvb_exclude_XH
* add modules qchem2bdf, qchem2cfour, qchem2dalton, qchem2gms, qchem2molcas, etc
* remove the keyword no10cycle
* add utility fch2cfour and module py2cfour
* fix uninitialized value bug in dal2fch
* move PDF manual to [online manual](https://jeanwsr.gitlab.io/mokit-doc-mdbook)
* add MacOS homebrew configuration/distribution (by ansatzX)
* move basis and lib to mokit/basis and mokit/lib, respectively (by jeanwsr)
* add conda configuration/distribution (by jeanwsr)
* add setup.py and requirements.txt
* add fpm.toml (fpm support)
* add LMO-EDA interface in frag_guess_wfn
* add MC-PDFT interface to PySCF and PySCF-forge
* add '-dft' argument for bas_fch2py
* allow to skip stable=opt in frag_guess_wfn
* add missing nopen for vir_idx in ist=3 when reading ROHF wfn
* remove the integer variable iout in source code
* support gen/genecp in automr
* add keyword HFonly
* update py2fch_direct

MOKIT 1.2.4 (Oct 25, 2022)
------------------------
* add py2bdf, py2dalton, py2gms, py2molcas, py2molpro, py2orca and py2psi
* add py2qchem for transferring MOs from PySCF to Q-Chem
* add GitLab-CI (by jeanwsr)
* split Makefile into multiple conditions (by jeanwsr)
* add compiler options for gfortran+OpenBLAS
* add keyword FcGVB to freeze all doubly occupied orbitals in GVB
* add the keyword Npair for non-GVB calculations
* add GVB interface to Q-Chem
* automatically change tPBE to T:PBE for OpenMolcas>=22.02
* improve DMRG keywords using OpenMolcas+QCMaquis
* construct supermolecule vir MOs using PAO, not direct sum of fragments
* no need for the environment variable $ORCA
* fix bug about X2C Hamiltonian keyword
* add GVB-BCCC2b/3b interface
* add State-Specific CASSCF interface
* add py2fch_direct (by jeanwsr)
* update bas_fch2py, fch2py and py2fch for complex GHF
* add utility fch2qchem

MOKIT 1.2.3 (Jun 11, 2022)
------------------------
* add ist=6 (GVB/STO-6G -> GVB/target basis set -> ...)
* add RHF -> CIS -> SA-NTO -> SA-CASSCF strategy
* add pcSseg-1 and pcSseg-2 into basis/
* assume 32-bit integer Dalton, reduce memory to 16GB if user specified >16GB
* add 3 keywords: DryRun, Nstate, Mixed_Spin, ICSS
* support specifying the number of pairs in RHF_proj case
* remove unused variables in source code, thanks to TiborGY
* update utility bas_gms2dal to generate ECP/PP data
* fix a bug in subroutine xml2fch_permute_15g, in file xml2fch.f90
* fix two numerical errors of array rh in read_fch.f90
* add keywords MkMRCCSD, BWMRCCSD, w/o (T); change keyword MRCC to FICMRCCSD
* add utilities chk2gbw, fch2wfn, fch247
* update radical index formulae
* fix a bug of py2fch when using small basis set like STO-3G/6G, 3-21G
* output Head-Gordon's unpaired electrons, biradical/tetraradical index y0/y1
* add keyword CASPT2K (interfaced with ORCA 5.x)
* compute +Q Davidson correction for MRCISD in OpenMolcas/GAMESS
* add keyword excludeXH and a utility gvb_exclude_XH
* supplement pairs when UNO pairs are not enough (commented)
* compatible keywords and scripts with Molpro 2021 and GAMESS 2021
* use minimal basis set def2-SVP (in RHF proj) for atoms>Xe, instead of STO-6G
* create all possible Python APIs in rwgeom.f90
* add GVB, OVB-MP2 interface to Gaussian
* add FIC-MRCC interface to ORCA(>=5.0.0)
* add SAPT0 PSI4 interface in utility frag_guess_wfn
* add keyword NMR for calculating nuclear shielding constants using Dalton
* add utilities bas_gms2dal, fch2dal and dal2fch (Gaussian <-> Dalton)
* put basis sets ANO-RCC-VDZP, ANO-RCC-VTZP and ANO-RCC-VQZP into basis/
* remove Sdiag in fch2py and py2fch, add write_pyscf_dm_into_fch
* change generated files of fch2mkl to *_o.inp and *_o.mkl
* extend utility frag_guess_wfn to generate GAMESS EDA input
* add utility fch2qm4d (Gaussian -> QM4D)
* add DFT/MRCI interfaces
* add keyword HF_prog (=Gaussian, PSI4, ORCA)

MOKIT 1.2.2 (Feb 24, 2021)
------------------------
* add CAS and MRCISD interfaces between AutoMR and PSI4
* add utilities bas_gms2psi, fch2psi and replace_xyz_in_inp
* add guess(fragment=N) support for input gjf
* add utilities bas_gau2molcas
* create directory basis to hold jkfit and some relativistic basis sets
* add RI, F12, DLPNO interfaces
* add Python APIs
* generate correct density in .fch for GVB and CAS
* add utility mkl2gjf
* add utility bdf2mkl (BDF -> ORCA)
* read orbital energies in utilities fch2bdf, bdf2fch, mkl2fch
* add CASPT3 and NEVPT3 interfaces
* add CAS, NEVPT2 and SDSPT2 interfaces of BDF
* add utility bdf2fch (BDF -> Gaussian)
* add utilities bas_gms2bdf and fch2bdf (Gaussian -> BDF)
* add MC-PDFT interface to GAMESS(>=2019R2)
* add NEVPT2 interface to Molpro
* add DKH2 and X2C interfaces of Molpro
* add background point charge interface to Molpro
* add CASSCF force interface to Molpro
* allow specification of active space (m,m) in dynamic correlation

MOKIT 1.2.1 (2020-12-15)
------------------------
* add interfaces for Molpro CASPT2(RS2C) and MRCISD(MRCIC)
* add utility xml2fch (Molpro -> Gaussian)
* read more digits of NOONs in some cases
* add interface for Molpro CASSCF
* add utilities bas_gms2molpro and fch2com (Gaussian -> Molpro)
* fix some Gfortran compiling incompatibility
* remove file program.info, read $ORCA and $GMS from environment variables
* add interfaces for MRMP2, MC-PDFT and DMRG-PDFT
* add keywords DKH2 and X2C
* fix the bug of utility dat2fch when '-no' specified
* update utilities fch2inp and dat2fch to support spherical harmonic functions for GAMESS
* change the keyword 'nocart'->'cart', now default spherical harmonic functions

MOKIT 1.1 beta (2020-09-25)
------------------------
* add interfaces for uc-/ic-/FIC-MRCISD
* add utility orb2fch
* fix bug: in fch2inp when gvb=True and nopen>3
* fix bug: 1 pair case in gvb_sort_pairs

MOKIT 1.1 alpha (2020-08-09)
------------------------
* support background point charges
* fix the bug of keyword 'force'
* add conditional compilation for Windows
* add pre-compiled Windows executables

MOKIT 1.0 beta (2020-06-28)
------------------------
* add program AutoMR
* fix the bug in fch2mkl
* add utility mkl2fch
* add the manual for MOKIT

MOKIT 1.0 alpha (2020-05-05)
------------------------
* Setup MOKIT
