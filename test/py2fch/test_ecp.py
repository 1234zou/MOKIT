from pyscf import gto
from py2fch_direct import mol2fch
from py2fch import py2fch

mol = gto.M(atom='Cu 0.0 0.0 0.1; Au 0.0 0.0 3.1', 
        basis= {'Cu': gto.parse('''
Cu    S
      8.1760000             -0.4210260
      2.5680000              0.7385924
      0.9587000              0.5525692
Cu    S
      8.1760000              0.1787665
      2.5680000             -0.3592273
      0.9587000             -0.4704825
      0.1153000              1.0807407
Cu    S
      0.0396000              1.0000000
Cu    P
     25.6300000             -0.0489173
      3.1660000              0.6272854
      1.0230000              0.4716188
Cu    P
      0.0860000              1.0000000
Cu    P
      0.0240000              1.0000000
Cu    D
     41.3400000              0.0465424
     11.4200000              0.2227824
      3.8390000              0.4539059
      1.2300000              0.5314769
Cu    D
      0.3102000              1.0000000
      '''), 'Au': gto.parse('''
Au    S
      2.8090000             -1.2021556
      1.5950000              1.6741578
      0.5327000              0.3526593
Au    S
      2.8090000              1.1608481
      1.5950000             -1.8642846
      0.5327000             -1.0356230
      0.2826000              1.3064399
Au    S
      0.0598000              1.0000000
Au    P
      3.6840000             -0.2802681
      1.6660000              0.7818398
      0.5989000              0.4804776
Au    P
      0.6838000             -0.0952078
      0.0977000              1.0299147
Au    P
      0.0279000              1.0000000
Au    D
      1.2870000              0.5844273
      0.4335000              0.5298161
Au    D
      0.1396000              1.0000000
''')},
ecp={'Cu': gto.parse_ecp(
'''
Cu nelec 10
Cu ul
1     511.9951763            -10.0000000
2      93.2801074            -72.5548282
2      23.2206669            -12.7450231
Cu S
0     173.1180854              3.0000000
1     185.2419886             23.8351825
2      73.1517847            473.8930488
2      14.6884157            157.6345823
Cu P
0     100.7191369              5.0000000
1     130.8345665              6.4990936
2      53.8683720            351.4605395
2      14.0989469             85.5016036
'''), 'Au':gto.parse_ecp('''
Au nelec 60
Au ul
1     622.6287956            -60.0000000
2     136.2843607           -555.5292312
2      33.1549781           -168.0019785
2       9.9894895            -63.0399875
2       3.0481312             -4.2516681
Au S
0     194.7374304              3.0000000
1     351.5327447             38.6020880
2     122.3270402            864.8370727
2      32.0914617            374.9935520
2       5.2451812            289.7910100
2       4.4916223           -152.4532773
Au P
0     420.6158801              2.0000000
1     109.4417815             73.8885625
2      34.1714280            326.6729872
2       5.9879750            126.5814591
Au D
0     219.2666158              3.0000000
1     122.7297786             55.6793149
2      63.1063369            449.1987335
2      18.3684520            215.0269091
2       4.4972844             64.0840995
Au F
0     108.5506037              4.0000000
1      56.4795527             51.8065335
2      29.2069159            231.2183113
2       9.5440543            119.0047386
2       2.8965118             15.3424188
''')}, 
        spin=2).build()
#mol = gto.M(atom='Cu 0.0 0.0 0.1; Au 0.0 0.0 3.1', basis='ano-rcc', 
#        spin=2).build()
mf = mol.UHF()
mf.conv_tol *= 0.1
mf.run()
#print(mf.mo_coeff)
#S = mol.intor('int1e_ovlp')
#print(S)
mol2fch(mol, 'testcu.fch', uhf=True)
py2fch('testcu.fch', mol.nao, mol.nao, mf.mo_coeff[0], 'a', mf.mo_energy[0], 0)
py2fch('testcu.fch', mol.nao, mol.nao, mf.mo_coeff[1], 'b', mf.mo_energy[1], 0)
